<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="Asciidoctor 2.0.10" name="generator"/>
  <meta content="Mandar Chitre" name="author"/>
  <title>
   Underwater Networks Handbook
  </title>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700" rel="stylesheet"/>
  <style>
   /* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
  </style>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
 </head>
 <body class="book toc2 toc-left">
  <div id="header">
   <h1>
    Underwater Networks Handbook
   </h1>
   <div class="details">
    <span class="author" id="author">
     Mandar Chitre
    </span>
    <br/>
    <span id="revnumber">
     version 3.0.0
    </span>
   </div>
   <div class="toc2" id="toc">
    <div id="toctitle">
     Table of Contents
    </div>
    <ul class="sectlevel1">
     <li>
      <a href="unet-handbook_preface.html">
       Preface
      </a>
     </li>
     <li>
      <a href="unet-handbook_part_i_introduction_to_unetstack.html">
       <strong>
        Part I: Introduction to UnetStack
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_introduction.html">
         1. Introduction
        </a>
       </li>
       <li>
        <a href="unet-handbook_getting_started.html">
         2. Getting started
        </a>
       </li>
       <li>
        <a href="unet-handbook_unetstack_basics.html">
         3. UnetStack basics
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_part_ii_setting_up_underwater_networks.html">
       <strong>
        Part II: Setting up underwater networks
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_unet_basics.html">
         4. Unet basics
        </a>
       </li>
       <li>
        <a href="unet-handbook_setting_up_small_networks.html">
         5. Setting up small networks
        </a>
       </li>
       <li>
        <a href="unet-handbook_routing_in_larger_networks.html">
         6. Routing in larger networks
        </a>
       </li>
       <li>
        <a href="unet-handbook_wired_and_over_the_air_links.html">
         7. Wired and over-the-air links
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_part_iii_building_unet_applications.html">
       <strong>
        Part III: Building Unet applications
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_interfacing_with_unetstack.html">
         8. Interfacing with UnetStack
        </a>
       </li>
       <li>
        <a href="unet-handbook_unetsocket_api.html">
         9. UnetSocket API
        </a>
       </li>
       <li>
        <a href="unet-handbook_portals.html">
         10. Portals
        </a>
       </li>
       <li>
        <a href="unet-handbook_at_script_engine.html">
         11. AT script engine
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_part_iv_understanding_unetstack_services.html">
       <strong>
        Part IV: Understanding UnetStack services
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_services_and_capabilities.html">
         12. Services and capabilities
        </a>
       </li>
       <li>
        <a href="unet-handbook_datagram_service.html">
         13. Datagram service
        </a>
       </li>
       <li>
        <a href="unet-handbook_physical_service.html">
         14. Physical service
        </a>
       </li>
       <li>
        <a href="unet-handbook_baseband_service.html">
         15. Baseband service
        </a>
       </li>
       <li>
        <a href="unet-handbook_ranging_and_synchronization.html">
         16. Ranging and synchronization
        </a>
       </li>
       <li>
        <a href="unet-handbook_node_information.html">
         17. Node information
        </a>
       </li>
       <li>
        <a href="unet-handbook_address_resolution.html">
         18. Address resolution
        </a>
       </li>
       <li>
        <a href="unet-handbook_medium_access_control.html">
         19. Medium access control
        </a>
       </li>
       <li>
        <a href="unet-handbook_single_hop_links.html">
         20. Single-hop links
        </a>
       </li>
       <li>
        <a href="unet-handbook_routing_and_route_maintenance.html">
         21. Routing and route maintenance
        </a>
       </li>
       <li>
        <a href="unet-handbook_transport_service.html">
         22. Transport service
        </a>
       </li>
       <li>
        <a href="unet-handbook_remote_access.html">
         23. Remote access
        </a>
       </li>
       <li>
        <a href="unet-handbook_state_persistence.html">
         24. State persistence
        </a>
       </li>
       <li>
        <a href="unet-handbook_scheduler.html">
         25. Scheduler
        </a>
       </li>
       <li>
        <a href="unet-handbook_shell.html">
         26. Shell
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_part_v_extending_unetstack.html">
       <strong>
        Part V: Extending UnetStack
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_developing_your_own_agents.html">
         27. Developing your own agents
        </a>
       </li>
       <li>
        <a href="unet-handbook_implementing_network_protocols.html">
         28. Implementing network protocols
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_part_vi_simulating_underwater_networks.html">
       <strong>
        Part VI: Simulating underwater networks
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_writing_simulation_scripts.html">
         29. Writing simulation scripts
        </a>
       </li>
       <li>
        <a href="unet-handbook_discrete_event_simulation.html">
         30. Discrete event simulation
        </a>
       </li>
       <li>
        <a href="unet-handbook_modems_and_channel_models.html">
         31. Modems and channel models
        </a>
       </li>
      </ul>
     </li>
     <li>
      <a href="unet-handbook_appendices.html">
       <strong>
        Appendices
       </strong>
      </a>
      <ul class="sectlevel1">
       <li>
        <a href="unet-handbook_command_reference.html">
         Appendix A: Command reference
        </a>
       </li>
       <li>
        <a href="unet-handbook_mysimplehandshakemac.html">
         Appendix B: MySimpleHandshakeMac
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </div>
  </div>
  <div id="content">
   <div class="sect1">
    <h2 id="_developing_your_own_agents">
     27. Developing your own agents
    </h2>
    <div class="sectionbody">
     <div class="paragraph">
      <p>
       By now, you should be very familiar with the concept of agents. You have interacted with them via commands and messages throughout this handbook, but what exactly is an agent?
      </p>
     </div>
     <div class="paragraph">
      <p>
       If you lookup the Wikipedia entry for a software agent, you’ll find:
      </p>
     </div>
     <div class="quoteblock">
      <blockquote>
       The term
       <strong>
        agent
       </strong>
       describes a software abstraction, an idea, or a concept, similar to object-oriented programming terms such as methods, functions, and objects. The concept of an agent provides a convenient and powerful way to describe a complex software entity that is capable of acting with a certain degree of autonomy in order to accomplish tasks on behalf of its host. But unlike objects, which are defined in terms of methods and attributes, an agent is defined in terms of its behavior.
      </blockquote>
      <div class="attribution">
       — Wikipedia: Software agent
       <br/>
       <cite>
        retrieved 8 September 2019
       </cite>
      </div>
     </div>
     <div class="paragraph">
      <p>
       In this chapter, we take this somewhat abstract concept and crystallize it by developing a simple agent. While the idea of writing your own agent might sound daunting at first, you’ll soon see that it is actually quite easy!
      </p>
     </div>
     <div class="sect2">
      <h3 id="_unet_agents">
       27.1. Unet agents
      </h3>
      <div class="paragraph">
       <p>
        Agents are the basic building blocks of the UnetStack. They exchange messages, provide services and implement protocols. While what is expected from a well-behaved agent is quite demanding, most of the necessary core behaviors are already implemented for you by the
        <a href="https://unetstack.net/javadoc/index.html?org/arl/unet/UnetAgent.html" rel="noopener" target="_blank">
         <code>
          UnetAgent
         </code>
        </a>
        base class. All you need to do is to extend it, and add in a little code to teach the agent what you want it to do.
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          While you have the option of writing agents in Java or Groovy (or any other language running on the Java VM), we recommend writing agents in Groovy, as Groovy agents tend to need less biolerplate code and are more readable and maintainable. They are also easier to test as Groovy classes can be dynamically loaded from source, without having to pre-compile them. However, if you are already an expert in Java and prefer to use it, you’re welcome to do so.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        The basic skeleton of a Groovy agent looks like this:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="groovy"><span class="kn">import</span> <span class="nn">org.arl.fjage.*</span>
<span class="kn">import</span> <span class="nn">org.arl.unet.*</span>

<span class="kd">class</span> <span class="nc">MyAgent</span> <span class="kd">extends</span> <span class="n">UnetAgent</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// this method is called when the stack is initialized</span>
    <span class="c1">// register services and capabilities that you provide here</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">startup</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// this method is called just after the stack is running</span>
    <span class="c1">// look up other agents and services here, as needed</span>
    <span class="c1">// subscribe to topics of interest to get notifications</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="n">Message</span> <span class="nf">processRequest</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// process requests supported by the agent, and return responses</span>
    <span class="c1">// if request is not processed, return null</span>
    <span class="k">return</span> <span class="kc">null</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// process other messages, such as notifications here</span>
    <span class="c1">// if a message is not interesting, it can be safely just ignored</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        While you don’t strictly need the
        <code>
         @Override
        </code>
        annotations, it is a good practice to use them whenever you are overriding a method from a superclass. The annotation tells the compiler that this is what you intend, and so if you make a typographical mistake and type in a wrong method name (one that doesn’t exist in the superclass), the compiler will warn you.
       </p>
      </div>
      <div class="paragraph">
       <p>
        If you do not need any of these methods, you can skip the definition as the base class provides default implementations. There are a several other methods that you can override to customize your agent, but these are less commonly needed and so we’ll skip them for now. You’ll come across them later.
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          If you happen to be already familiar with the
          <a href="https://fjage.readthedocs.io/en/latest/behaviors.html#agent-lifecycle" rel="noopener" target="_blank">
           fjåge agent lifecycle
          </a>
          , you may wish to note that the
          <code>
           setup()
          </code>
          method is called from the
          <code>
           init()
          </code>
          method of the agent. The
          <code>
           startup()
          </code>
          method is called from a one-shot behavior scheduled during initialization. The
          <code>
           processRequest()
          </code>
          and
          <code>
           processMessage()
          </code>
          methods are called from a message behavior added during initialization.
         </td>
        </tr>
       </table>
      </div>
     </div>
     <div class="sect2">
      <h3 id="_groovy_echo_daemon">
       27.2. Groovy echo daemon
      </h3>
      <div class="paragraph">
       <p>
        It’s best to illustrate with a simple example.
       </p>
      </div>
      <div class="paragraph">
       <p>
        Let’s develop an
        <em>
         echo daemon
        </em>
        that will respond to each incoming
        <em>
         echo request
        </em>
        datagram with an
        <em>
         echo response
        </em>
        datagram containing the same data as the echo-request. We need a way to identify which datagram is an echo request, as we don’t want to be echoing datagrams intended for other agents or for the user. We do this by defining an echo request datagram as any datagram with protocol
        <code>
         USER
        </code>
        (recall that protocol numbers from
        <code>
         USER
        </code>
        onwards are available for your own applications to use). We do not want the response to use the same protocol, otherwise our daemon (running on the source node) could get confused and echo the response, which would in turn be echoed again by the destination node’s daemon, ad infinitum. So we use protocol
        <code>
         DATA
        </code>
        for the echo response datagram, as this protocol is intended for generic application data.
       </p>
      </div>
      <div class="paragraph">
       <p>
        Here’s our daemon:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="groovy"><span class="kn">import</span> <span class="nn">org.arl.fjage.*</span>
<span class="kn">import</span> <span class="nn">org.arl.unet.*</span>

<span class="kd">class</span> <span class="nc">EchoDaemon</span> <span class="kd">extends</span> <span class="n">UnetAgent</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">startup</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// subscribe to all agents that provide the datagram service</span>
    <span class="n">subscribeForService</span><span class="o">(</span><span class="n">Services</span><span class="o">.</span><span class="na">DATAGRAM</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="k">instanceof</span> <span class="n">DatagramNtf</span> <span class="o">&amp;&amp;</span> <span class="n">msg</span><span class="o">.</span><span class="na">protocol</span> <span class="o">==</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">USER</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// respond to protocol USER datagram with protocol DATA datagram</span>
      <span class="n">send</span> <span class="k">new</span> <span class="nf">DatagramReq</span><span class="o">(</span>
        <span class="nl">recipient:</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span>
        <span class="nl">to:</span> <span class="n">msg</span><span class="o">.</span><span class="na">from</span><span class="o">,</span>
        <span class="nl">protocol:</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">DATA</span><span class="o">,</span>
        <span class="nl">data:</span> <span class="n">msg</span><span class="o">.</span><span class="na">data</span>
      <span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        Let’s walk through the above code:
       </p>
      </div>
      <div class="olist arabic">
       <ol class="arabic">
        <li>
         <p>
          Our agent does not provide any formal services or capabilities, so we we skip the
          <code>
           setup()
          </code>
          and
          <code>
           processRequest()
          </code>
          methods from the skeleton.
         </p>
        </li>
        <li>
         <p>
          The
          <code>
           startup()
          </code>
          method looks up all agents providing the DATAGRAM service, and subscribes to any notifications from any of these agents. These notifications will inlcude the
          <code>
           DatagramNtf
          </code>
          messages that are published when datagrams are received from another node. When a notification arrives, the
          <code>
           processMessage()
          </code>
          method will be called.
         </p>
        </li>
        <li>
         <p>
          In the
          <code>
           processMessage()
          </code>
          method, we check for datagram notifications with protocol
          <code>
           USER
          </code>
          , and respond to each of them by sending a
          <code>
           DatagramReq
          </code>
          to the sender of the notification, requesting it to send a datagram with protocol
          <code>
           DATA
          </code>
          to the node that sent the echo request, with the data copied from the echo request.
         </p>
        </li>
       </ol>
      </div>
      <div class="paragraph">
       <p>
        That’s it!
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          Do not get confused between
          <code>
           sender
          </code>
          and
          <code>
           from
          </code>
          , and
          <code>
           recipient
          </code>
          and
          <code>
           to
          </code>
          fields in datagram messages. The
          <code>
           sender
          </code>
          and
          <code>
           recipient
          </code>
          <strong>
           always
          </strong>
          refer to the agents that generate and consume the message, respectively. These are entities within a single Unet node. The
          <code>
           from
          </code>
          and
          <code>
           to
          </code>
          are node addresses that tell us which node is transmitting the datagram, and which node is the intended destination.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        It’s time for us to test this agent. Create a file called
        <code>
         EchoDaemon.groovy
        </code>
        in the
        <code>
         classes
        </code>
        folder and copy the above daemon code into it.
       </p>
      </div>
      <div class="sidebarblock">
       <div class="content">
        <div class="title">
         Editing scripts and classes
        </div>
        <div class="paragraph">
         <p>
          With the Unet simulator or Unet audio running on your machine, you can use your favorite text editor to directly create the
          <code>
           EchoDaemon.groovy
          </code>
          in the
          <code>
           classes
          </code>
          folder. However, a more generic way (that works on modems as well) is to open node A’s shell, select
          <code>
           Script editor
          </code>
          , and use the new file button (
          <span class="icon">
           <i class="fa fa-file">
           </i>
          </span>
          ) in the
          <code>
           /classes/
          </code>
          section to create the file:
         </p>
        </div>
        <div class="imageblock text-center">
         <div class="content">
          <img alt="script editor 1" src="images/script-editor-1.png" width="80%"/>
         </div>
        </div>
        <div class="paragraph">
         <p>
          The same approach can be used to create Groovy scripts in the
          <code>
           scripts
          </code>
          folder.
         </p>
        </div>
       </div>
      </div>
      <div class="paragraph">
       <p>
        Now start the 2-node network simulation that we have been using as a testbed, and on node B, load the agent:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span>container.add <span class="s1">'echo'</span>, new EchoDaemon<span class="o">()</span><span class="p">;</span>             <i class="conum" data-value="1"></i><b>(1)</b>
<span class="gp">&gt;</span><span class="w"> </span>ps
<span class="go">remote: org.arl.unet.remote.RemoteControl - IDLE
state: org.arl.unet.state.StateManager - IDLE
rdp: org.arl.unet.net.RouteDiscoveryProtocol - IDLE
ranging: org.arl.unet.phy.Ranging - IDLE
uwlink: org.arl.unet.link.ECLink - IDLE
node: org.arl.unet.nodeinfo.NodeInfo - IDLE
websh: org.arl.fjage.shell.ShellAgent - RUNNING
simulator: org.arl.unet.sim.SimulationAgent - IDLE
phy: org.arl.unet.sim.HalfDuplexModem - IDLE
bbmon: org.arl.unet.bb.BasebandSignalMonitor - IDLE
arp: org.arl.unet.addr.AddressResolution - IDLE
transport: org.arl.unet.transport.SWTransport - IDLE
echo: EchoDaemon - IDLE                               <i class="conum" data-value="2"></i><b>(2)</b>
router: org.arl.unet.net.Router - IDLE
mac: org.arl.unet.mac.CSMA - IDLE
WebGW-5c9c1c68385a388f: REMOTE</span></code></pre>
       </div>
      </div>
      <div class="colist arabic">
       <table>
        <tr>
         <td>
          <i class="conum" data-value="1">
          </i>
          <b>
           1
          </b>
         </td>
         <td>
          Create an agent called
          <code>
           echo
          </code>
          based on the
          <code>
           EchoDaemon
          </code>
          class.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="2">
          </i>
          <b>
           2
          </b>
         </td>
         <td>
          We see that the
          <code>
           echo
          </code>
          agent is now running.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        Our daemon is up and running!
       </p>
      </div>
      <div class="sidebarblock">
       <div class="content">
        <div class="title">
         Debugging agents
        </div>
        <div class="paragraph">
         <p>
          If you have any errors in the
          <code>
           EchoDaemon.groovy
          </code>
          that cause compilation to fail, the agent won’t load, and you’ll get an error message on the shell. Sometimes it helps to look at the log file (
          <code>
           logs/log-0.txt
          </code>
          ) for more details on the error.
         </p>
        </div>
        <div class="paragraph">
         <p>
          In some rare cases, instead of printing an error, the shell may simply refuse to run the command by showing a "-" and waiting for more input because it thinks that the command you gave is incomplete. If this happens, look at your code to find the error, or try compiling manually using
          <code>
           groovyc
          </code>
          (similar to
          <code>
           javac
          </code>
          command in the next section) to get more details on the error.
         </p>
        </div>
       </div>
      </div>
      <div class="paragraph">
       <p>
        Once the daemon is successfully loaded on node B, we can test it from node A:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span>subscribe phy                                       <i class="conum" data-value="1"></i><b>(1)</b>
<span class="gp">&gt;</span><span class="w"> </span>phy <span class="o">&lt;&lt;</span> <span class="no">new</span><span class="sh"> DatagramReq(to: host('B'), protocol: Protocol.USER, data: [42]) <i class="conum" data-value="2"></i><b>(2)</b>
</span><span class="go">AGREE
</span><span class="gp">phy &gt;</span><span class="o">&gt;</span> TxFrameNtf:INFORM[type:DATA txTime:2809812247]
<span class="gp">phy &gt;</span><span class="o">&gt;</span> RxFrameStartNtf:INFORM[type:DATA rxTime:2811767943]
<span class="gp">phy &gt;</span><span class="o">&gt;</span> RxFrameNtf:INFORM[type:DATA from:31 to:232 rxTime:2811767943 <span class="o">(</span>1 byte<span class="o">)]</span>
<span class="gp">&gt;</span><span class="w"> </span>ntf.data
<span class="go">[42]                                                  <i class="conum" data-value="3"></i><b>(3)</b>
</span></code></pre>
       </div>
      </div>
      <div class="colist arabic">
       <table>
        <tr>
         <td>
          <i class="conum" data-value="1">
          </i>
          <b>
           1
          </b>
         </td>
         <td>
          We subscribe to
          <code>
           phy
          </code>
          so that we can see the incoming echo response from the peer node.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="2">
          </i>
          <b>
           2
          </b>
         </td>
         <td>
          Transmit a physical layer frame containing the echo request and some data.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="3">
          </i>
          <b>
           3
          </b>
         </td>
         <td>
          The data we sent was echoed back.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        We have written our first agent! Was easy, wasn’t it?
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          Unet modems also have a
          <code>
           classes
          </code>
          folder that accepts Groovy source files or compiled Java/Groovy class files. You can use the web interface of the modem to upload files to that folder. If your code has many class files, you may wish to package them together into a jar archive and place it in the
          <code>
           jars
          </code>
          folder.
         </td>
        </tr>
       </table>
      </div>
     </div>
     <div class="sect2">
      <h3 id="_java_echo_daemon">
       27.3. Java echo daemon
      </h3>
      <div class="paragraph">
       <p>
        If you’re a Java programmer and find the Groovy syntax daunting, you might prefer to write your agents in pure Java (at the expense of verbosity and more steps for testing). This is the equivalent Java code below for the Groovy agent we developed in the last section:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="java"><span class="kn">import</span> <span class="nn">org.arl.fjage.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.arl.unet.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EchoDaemon</span> <span class="kd">extends</span> <span class="nc">UnetAgent</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">startup</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// subscribe to all agents that provide the datagram service</span>
    <span class="n">subscribeForService</span><span class="o">(</span><span class="nc">Services</span><span class="o">.</span><span class="na">DATAGRAM</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="nc">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="k">instanceof</span> <span class="nc">DatagramNtf</span> <span class="o">&amp;&amp;</span> <span class="o">((</span><span class="nc">DatagramNtf</span><span class="o">)</span><span class="n">msg</span><span class="o">).</span><span class="na">getProtocol</span><span class="o">()</span> <span class="o">==</span> <span class="nc">Protocol</span><span class="o">.</span><span class="na">USER</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// we got an echo request!</span>
      <span class="c1">// respond with a protocol DATA datagram</span>
      <span class="nc">DatagramNtf</span> <span class="n">ntf</span> <span class="o">=</span> <span class="o">(</span><span class="nc">DatagramNtf</span><span class="o">)</span><span class="n">msg</span><span class="o">;</span>
      <span class="nc">DatagramReq</span> <span class="n">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatagramReq</span><span class="o">(</span><span class="n">ntf</span><span class="o">.</span><span class="na">getSender</span><span class="o">());</span>
      <span class="n">req</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">ntf</span><span class="o">.</span><span class="na">getFrom</span><span class="o">());</span>
      <span class="n">req</span><span class="o">.</span><span class="na">setProtocol</span><span class="o">(</span><span class="nc">Protocol</span><span class="o">.</span><span class="na">DATA</span><span class="o">);</span>
      <span class="n">req</span><span class="o">.</span><span class="na">setData</span><span class="o">(</span><span class="n">ntf</span><span class="o">.</span><span class="na">getData</span><span class="o">());</span>
      <span class="n">send</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        In Java, you’ll first need to compile the Java code. Create a
        <code>
         EchoDaemon.java
        </code>
        file with the above contents. To compile it, you’ll need to have fjåge and unet-framework jar files on the classpath:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="shell"><span class="nv">$ </span>javac <span class="nt">-cp</span> lib/fjage-1.6.jar:lib/unet-framework-3.0.0.jar EchoDaemon.java</code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        You should now have a
        <code>
         EchoDaemon.class
        </code>
        file which you copy to the
        <code>
         classes
        </code>
        folder. To avoid duplicate classes, remember to first delete the
        <code>
         EchoDaemon.groovy
        </code>
        file!
       </p>
      </div>
      <div class="paragraph">
       <p>
        Finally, you can run the 2-node network simulator and test the agent, just as you did in the previous section.
       </p>
      </div>
     </div>
     <div class="sect2">
      <h3 id="_behaviors">
       27.4. Behaviors
      </h3>
      <div class="paragraph">
       <p>
        Agents implement most of their functionality with behaviors.
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          UnetStack is implemented on top of the
          <a href="https://fjage.readthedocs.io/en/latest/introduction.html" rel="noopener" target="_blank">
           fjåge
          </a>
          agent framework. fjåge provides a set of standard behaviors for agents to extend. We will explore some of these behaviors in this section, but you are encouraged to read the
          <a href="https://fjage.readthedocs.io/en/latest/index.html">
           fjåge documentation
          </a>
          at your leisure to learn more.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        We have been implicitly using two behaviors so far. The
        <code>
         startup()
        </code>
        method is called by the
        <code>
         UnetAgent
        </code>
        base class using a
        <code>
         OneShotBehavior
        </code>
        , and the
        <code>
         processMessage()
        </code>
        method is called from a
        <code>
         MessageBehavior
        </code>
        . While you could have manually added these behaviors, the
        <code>
         UnetAgent
        </code>
        base class does this for you, because almost all Unet agents require this.
       </p>
      </div>
      <div class="paragraph">
       <p>
        Let’s next look at a use case for explicitly adding other behaviors. Say we wanted our echo daemon to not respond immediately, but after 7 seconds. How would we do that?
       </p>
      </div>
      <div class="paragraph">
       <p>
        We could of course add a
        <code>
         delay(7000)
        </code>
        in the
        <code>
         processMessage()
        </code>
        method, but that would be a bad idea. If we did that, the agent would sleep for 7 seconds on receiving a request and not process any request from any other nodes! We want the agent to be responsive while waiting, and so do not want to block execution. Instead, we want a behavior that will occur 7 seconds later — this is precisely what a
        <code>
         WakerBehavior
        </code>
        does. Here’s our new
        <code>
         processMessage()
        </code>
        method:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="groovy">  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="k">instanceof</span> <span class="n">DatagramNtf</span> <span class="o">&amp;&amp;</span> <span class="n">msg</span><span class="o">.</span><span class="na">protocol</span> <span class="o">==</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">USER</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// respond to protocol USER datagram with protocol DATA datagram after 7 seconds</span>
      <span class="n">add</span> <span class="k">new</span> <span class="nf">WakerBehavior</span><span class="o">(</span><span class="mi">7000</span><span class="o">,</span> <span class="o">{</span>
        <span class="n">send</span> <span class="k">new</span> <span class="nf">DatagramReq</span><span class="o">(</span>
          <span class="nl">recipient:</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span>
          <span class="nl">to:</span> <span class="n">msg</span><span class="o">.</span><span class="na">from</span><span class="o">,</span>
          <span class="nl">protocol:</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">DATA</span><span class="o">,</span>
          <span class="nl">data:</span> <span class="n">msg</span><span class="o">.</span><span class="na">data</span>
        <span class="o">)</span>
      <span class="o">})</span>
    <span class="o">}</span>
  <span class="o">}</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        The
        <code>
         WakerBehavior
        </code>
        that we add is triggered 7000 ms later, and the echo response is sent in that behavior. Simple!
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          Behaviors in Groovy use closures to make the syntax easy to work with. If you were writing your agent in Java, you’d need to create an anonymous class and override the
          <code>
           onWake()
          </code>
          method.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        Go ahead and replace the
        <code>
         processMessage()
        </code>
        method in your
        <code>
         EchoDaemon.groovy
        </code>
        file and try it! In order to reload the agent, all you need to do on node B is:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span>container.kill <span class="nb">echo</span>
<span class="go">true
</span><span class="gp">&gt;</span><span class="w"> </span>container.add <span class="s1">'echo'</span>, new EchoDaemon<span class="o">()</span><span class="p">;</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        And now you can send an echo request from node A as before and see that the response is delayed by 7 seconds.
       </p>
      </div>
      <div class="paragraph">
       <p>
        You could also send a second request during those 7 seconds, and the echo daemon on node B would process that concurrently. You can send 2 echo requests right after each other, and you’ll see the corresponding echo responses 7 seconds later, but right after each other.
       </p>
      </div>
      <div class="sidebarblock">
       <div class="content">
        <div class="title">
         fjåge behaviors
        </div>
        <div class="paragraph">
         <p>
          fjåge provides several behaviors that are commonly used in Unet agents:
         </p>
        </div>
        <div class="dlist">
         <dl>
          <dt class="hdlist1">
           One-shot behavior
          </dt>
          <dd>
           <p>
            A behavior that is run only once at the earliest opportunity.
           </p>
          </dd>
          <dt class="hdlist1">
           Cyclic behavior
          </dt>
          <dd>
           <p>
            A cyclic behavior is run repeatedly as long as it is active. The behavior may be blocked and restarted as necessary.
           </p>
          </dd>
          <dt class="hdlist1">
           Waker behavior
          </dt>
          <dd>
           <p>
            A behavior that is run after a specified delay in milliseconds.
           </p>
          </dd>
          <dt class="hdlist1">
           Ticker behavior
          </dt>
          <dd>
           <p>
            A behavior that runs repeatedly with a specified delay between invocations.
           </p>
          </dd>
          <dt class="hdlist1">
           Backoff behavior
          </dt>
          <dd>
           <p>
            A behavior that is similar to the waker behavior, but allows the wakeup time to be extended dynamically. This is typically useful to implement backoff or retry timeouts.
           </p>
          </dd>
          <dt class="hdlist1">
           Poisson behavior
          </dt>
          <dd>
           <p>
            A behavior that is similar to a ticker behavior, but the interval between invocations is an exponentially distributed random variable. This simulates a Poisson arrival process, commonly used to model network data sources.
           </p>
          </dd>
          <dt class="hdlist1">
           Finite state machine behavior
          </dt>
          <dd>
           <p>
            Finite state machines are commonly used to implement network protocols. They can easily be implemented using this behavior. These machines are composed of multiple states, each of which is like a cyclic behavior, with state transitions that can be triggered by the component behaviors.
           </p>
          </dd>
         </dl>
        </div>
        <div class="paragraph">
         <p>
          You can read more about these behaviors in the fjåge documentation on
          <a href="https://fjage.readthedocs.io/en/latest/behaviors.html" rel="noopener" target="_blank">
           Agents &amp; Behaviors
          </a>
          .
         </p>
        </div>
       </div>
      </div>
     </div>
     <div class="sect2">
      <h3 id="_parameters_9">
       27.5. Parameters
      </h3>
      <div class="paragraph">
       <p>
        We have seen many agents with parameters that you can get/set. If we wanted to make our echo daemon delay configurable, it would be perfect to expose it as a parameter. Let’s do that next.
       </p>
      </div>
      <div class="paragraph">
       <p>
        With the echo daemon loaded on node B, we see that it doesn’t have any configurable parameters by default:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span><span class="nb">echo</span>
<span class="gp">&lt;&lt;&lt; EchoDaemon &gt;</span><span class="o">&gt;&gt;</span></code></pre>
       </div>
      </div>
      <div class="paragraph">
       <p>
        Let’s add a title, description and one
        <code>
         delay
        </code>
        parameter to our daemon:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="groovy"><span class="kn">import</span> <span class="nn">org.arl.fjage.*</span>
<span class="kn">import</span> <span class="nn">org.arl.unet.*</span>

<span class="kd">class</span> <span class="nc">EchoDaemon</span> <span class="kd">extends</span> <span class="n">UnetAgent</span> <span class="o">{</span>

  <span class="kd">enum</span> <span class="n">Params</span> <span class="kd">implements</span> <span class="n">Parameter</span> <span class="o">{</span>        <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="n">delay</span>
  <span class="o">}</span>

  <span class="kd">final</span> <span class="n">String</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">'Echo Daemon'</span>        <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="kd">final</span> <span class="n">String</span> <span class="n">description</span> <span class="o">=</span> <span class="s1">'Echoes any USER datagrams back as DATA'</span> <i class="conum" data-value="3"></i><b>(3)</b>

  <span class="kt">int</span> <span class="n">delay</span> <span class="o">=</span> <span class="mi">7000</span>                          <i class="conum" data-value="4"></i><b>(4)</b>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">startup</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// subscribe to all agents that provide the datagram service</span>
    <span class="n">subscribeForService</span><span class="o">(</span><span class="n">Services</span><span class="o">.</span><span class="na">DATAGRAM</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">processMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="k">instanceof</span> <span class="n">DatagramNtf</span> <span class="o">&amp;&amp;</span> <span class="n">msg</span><span class="o">.</span><span class="na">protocol</span> <span class="o">==</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">USER</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// respond to protocol USER datagram with protocol DATA datagram after 7 seconds</span>
      <span class="n">add</span> <span class="k">new</span> <span class="nf">WakerBehavior</span><span class="o">(</span><span class="n">delay</span><span class="o">,</span> <span class="o">{</span>
        <span class="n">send</span> <span class="k">new</span> <span class="nf">DatagramReq</span><span class="o">(</span>
          <span class="nl">recipient:</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">,</span>
          <span class="nl">to:</span> <span class="n">msg</span><span class="o">.</span><span class="na">from</span><span class="o">,</span>
          <span class="nl">protocol:</span> <span class="n">Protocol</span><span class="o">.</span><span class="na">DATA</span><span class="o">,</span>
          <span class="nl">data:</span> <span class="n">msg</span><span class="o">.</span><span class="na">data</span>
        <span class="o">)</span>
      <span class="o">})</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="n">List</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span> <span class="n">getParameterList</span><span class="o">()</span> <span class="o">{</span>      <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="n">allOf</span><span class="o">(</span><span class="n">Params</span><span class="o">)</span>
  <span class="o">}</span>

<span class="o">}</span></code></pre>
       </div>
      </div>
      <div class="colist arabic">
       <table>
        <tr>
         <td>
          <i class="conum" data-value="1">
          </i>
          <b>
           1
          </b>
         </td>
         <td>
          Declare a list of parameters that the agent advertises. We have declared this enum as an inner class, but you could choose to declare it as a separate class if you wish.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="2">
          </i>
          <b>
           2
          </b>
         </td>
         <td>
          Provide a descriptive title for the agent.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="3">
          </i>
          <b>
           3
          </b>
         </td>
         <td>
          Provide a descriptive text for the agent.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="4">
          </i>
          <b>
           4
          </b>
         </td>
         <td>
          Declare the parameter.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="5">
          </i>
          <b>
           5
          </b>
         </td>
         <td>
          Advertise the list of parameters.
         </td>
        </tr>
       </table>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          Note that we had to take 3 steps to add a parameter: declare a list of parameters, declare the parameter, and advertise the parameter. While this might seem like a lot, bear in mind that parameters are much more than just an agent’s class attributes. Parameters can be get/set remotely, even from a different Java VM, different computer, or through a UnetSocket gateway API.
         </td>
        </tr>
       </table>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          If you were writing the agent in Java instead of Groovy, you’d need to implement getters and setters for parameter
          <code>
           delay
          </code>
          , rather than simply declare the attribute. This is because Groovy automatically creates the getters and setters for you.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        Let’s see how the agent looks with parameters. Reload the agent on node B and check its parameters:
       </p>
      </div>
      <div class="listingblock">
       <div class="content">
        <pre class="rouge highlight"><code data-lang="console"><span class="gp">&gt;</span><span class="w"> </span>container.kill agent<span class="o">(</span><span class="s1">'echo'</span><span class="o">)</span>
<span class="go">true
</span><span class="gp">&gt;</span><span class="w"> </span>container.add <span class="s1">'echo'</span>, new EchoDaemon<span class="o">()</span><span class="p">;</span>
<span class="gp">&gt;</span><span class="w"> </span><span class="nb">echo</span>
<span class="gp">&lt;&lt;&lt; Echo Daemon &gt;</span><span class="o">&gt;&gt;</span>                      <i class="conum" data-value="1"></i><b>(1)</b>
<span class="go">
Echoes any USER datagrams back as DATA   <i class="conum" data-value="2"></i><b>(2)</b>

[EchoDaemon.Params]
  delay = 7000

</span><span class="gp">&gt;</span><span class="w"> </span>echo.delay
<span class="go">7000
</span><span class="gp">&gt;</span><span class="w"> </span>echo.delay <span class="o">=</span> 5000
<span class="go">5000
</span><span class="gp">&gt;</span><span class="w"> </span>echo.delay
<span class="go">5000</span></code></pre>
       </div>
      </div>
      <div class="colist arabic">
       <table>
        <tr>
         <td>
          <i class="conum" data-value="1">
          </i>
          <b>
           1
          </b>
         </td>
         <td>
          Notice the change in title.
         </td>
        </tr>
        <tr>
         <td>
          <i class="conum" data-value="2">
          </i>
          <b>
           2
          </b>
         </td>
         <td>
          The description is shown here.
         </td>
        </tr>
       </table>
      </div>
      <div class="paragraph">
       <p>
        We have changed the delay from 7 seconds to 5 seconds. Go ahead and send a echo request from node A and see that you get a response back in 5 seconds!
       </p>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          If you want to compute parameter values on demand or validate parameters, you can implement getters/setters for the parameter, and they will be called. If you want a read-only parameter, you can declare the attribute as
          <code>
           private
          </code>
          and implement only a getter for that parameter.
         </td>
        </tr>
       </table>
      </div>
      <div class="admonitionblock tip">
       <table>
        <tr>
         <td class="icon">
          <i class="fa icon-tip" title="Tip">
          </i>
         </td>
         <td class="content">
          While our example above uses a static description, the description can also be dynamic. This can be useful if you want to display agent’s status information in the description. To implement dynamic descriptions, simply replace the
          <code>
           description
          </code>
          attribute by a getter
          <code>
           getDescription()
          </code>
          that returns a
          <code>
           String
          </code>
          description when called.
         </td>
        </tr>
       </table>
      </div>
     </div>
     <div class="sect2">
      <h3 id="_services_capabilities_and_notifications">
       27.6. Services, capabilities, and notifications
      </h3>
      <div class="paragraph">
       <p>
        Most of the agents we have been interacting with, have advertised services, and sometimes, optional capabilities. They also honor requests and publish unsolicited notifications. All of these are quite straightforward to implement, and you can explore some of these features in this
        <a href="https://blog.unetstack.net/developing-modem-drivers-for-unetstack" rel="noopener" target="_blank">
         blog article
        </a>
        on how to implement a simple PHYSICAL service agent (modem driver). We will explore some of these in the next chapter, along with other cool features like finite state machine behaviors and protocol data unit (PDU) codecs.
       </p>
      </div>
     </div>
    </div>
   </div>
   <table width="100%">
    <tr>
     <td align="left" width="50%">
      <a href="unet-handbook_shell.html" style="text-decoration: none;">
       &lt;&lt;&lt; [Shell]
      </a>
     </td>     <td align="right" width="50%">
      <a href="unet-handbook_implementing_network_protocols.html" style="text-decoration: none;">
       [Implementing network protocols] &gt;&gt;&gt;
      </a>
     </td>
    </tr>
   </table>
  </div>
  <div id="footer">
   <div id="footer-text">
    Version 3.0.0
    <br/>
    Last updated 2019-09-26 15:30:51 +0800
   </div>
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-52885583-1', 'auto');
    ga('send', 'pageview');
</script>
  </div>
  <style>
   pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
  </style>
 </body>
</html>
